# Migration Runbook â€” Adopt from private `eudr_dmi`

This runbook describes how to adopt code and documentation from the private `eudr_dmi` repository into this public, authoritative repository.

This document is intentionally conservative. It defines **adoption boundaries** and **do-not-copy rules** to reduce the risk of publishing secrets, runtime data, or generated artefacts.

## Adoption Boundaries (Copy + Own)

Adoption into this repository is **copy + own**:

- Material is copied into this repository and then maintained here.
- Provenance for each adoption must be recorded in `ADOPTION_LOG.md`.
- Adoption should be performed via pull request with human review.

## Do-Not-Copy Rules (Hard Exclusions)

Do not copy, publish, or commit any of the following:

- Secrets and environment files: `.env*`
- Key material: `keys.yml` (and any files containing private keys, API keys, or signing material)
- Runtime data plane: `/Users/server/data/dmi` (or any equivalent data-plane path)
- Generated / operational artefacts:
  - `audit/`
  - `outputs/`

If any of the above are present in the source tree, the migration process must exclude them.

## Tooling

An idempotent migration scaffold is provided under `scripts/migrate_from_private_eudr_dmi/`.

The migration tool:

- Copies a source snapshot into `adopted/private_eudr_dmi_snapshot/`.
- Applies hard excludes.
- Produces a deterministic SHA-256 manifest at `adopted/private_eudr_dmi_snapshot/latest_manifest.sha256`.

## Procedure

1. Ensure you have access to the private `eudr_dmi` repository on your machine.
2. Choose a source reference (commit/tag) and produce or check out a clean source working tree.
3. Run the migration script (see `scripts/migrate_from_private_eudr_dmi/README.md`).
4. Review the resulting snapshot and confirm excluded paths are not present.
5. Record provenance in `ADOPTION_LOG.md` (source reference, scope, exclusions, transformations).
6. Open a pull request for review.

## Acceptance Criteria (Adoption PR)

- Repository contains no secrets, `.env*`, or key material (including `keys.yml`).
- No runtime data plane paths are copied (including `/Users/server/data/dmi`).
- No `audit/` or `outputs/` directories are adopted.
- `ADOPTION_LOG.md` contains a complete entry for the adoption PR.
- `adopted/private_eudr_dmi_snapshot/latest_manifest.sha256` is regenerated by the migration tool and matches the snapshot contents.
- Changes are versioned, reproducible, and reviewable via the pull request.
